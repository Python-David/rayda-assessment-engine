# Multi-Tenant SaaS Platform Backend

## Project Overview

This project is a robust, production-grade backend system designed to support a **multi-tenant SaaS platform** with external integration capabilities.  
It emphasizes **secure tenant isolation**, role-based access control (RBAC), and scalable architecture.  

---

## Architectural Decisions

- **Multi-Tenant Design**: Each organization (tenant) has isolated data, scoped by `org_id`. This ensures no data leaks between organizations.
- **No Public Registration**: Instead of letting anyone register arbitrarily, the system enforces controlled onboarding through superadmin-created organizations and admin-created users. This aligns with real-world SaaS practices.
- **Role-Based Access Control (RBAC)**: Roles determine what actions each user can perform, providing fine-grained security.
- **PostgreSQL + SQLAlchemy**: Relational database with strong consistency guarantees and SQLAlchemy ORM for flexibility.
- **FastAPI**: High-performance, modern API framework supporting async workflows.

---

## Roles & Permissions Design (Thought Process)

### Why no open registration?

In real SaaS environments, organizations want to control who can access their data and represent their company.  
Allowing public registration would break this trust model and potentially introduce rogue users.

---

### **Superadmin**

- **Responsibilities**:
  - Create new organizations (tenants).
  - Assign an initial admin for each new organization.
- **Scope**:
  - Global â€” no org_id restriction.
- **Rationale**:
  - Mirrors a SaaS owner or system-level administrator in enterprise systems.

---

### **Admin**

- **Responsibilities**:
  - Create and manage users within their own organization.
  - Can create both `user` and additional `admin` roles but cannot escalate to superadmin.
- **Scope**:
  - Limited to their assigned `org_id`.
- **Rationale**:
  - Represents IT admins or team leads who handle internal user management.

---

### **User**

- **Responsibilities**:
  - Manage and view their own profile (represented at this point by this `/me` endpoint).
- **Scope**:
  - Strictly limited to self, within their organization.
- **Rationale**:
  - Represents normal end-users within an org.

---

### Principles Behind Our RBAC

- **Least Privilege**: Every user only has permissions essential for their role.
- **Explicit Control**: No hidden escalations or untracked permissions.
- **Tenant Isolation**: No cross-org actions allowed for admins or users.
- **Security Over Convenience**: No open sign-ups, no role self-assignment.

---

## Tech Stack

- **FastAPI**: Web framework for building APIs quickly and cleanly.
- **SQLAlchemy**: ORM and database toolkit.
- **Alembic**: Database migrations (I miss Django).
- **Pydantic**: Data validation and settings management.
- **PostgreSQL**: Primary database.
- **JWT (python-jose)**: Authentication tokens.
- **Docker & Docker Compose**: Easy uniform environment setup and isolation.
- **Passlib**: Secure password hashing.

---

## How it works

1. **Superadmin Bootstrap**
   - Created automatically on first run using `.env` values.
   - Example (essential):
     ```
     INITIAL_SUPERADMIN_EMAIL=superadmin@example.com
     INITIAL_SUPERADMIN_PASSWORD=SuperSecret123!
     ```

2. **Superadmin Login**
   - Logs in via `/users/login` or basically via Swagger docs at the point of accessing protected enpoints.
   - Receives JWT token.

3. **Create Organization**
   - Superadmin uses token to create a new org and assign initial admin via `/orgs/` POST endpoint.

4. **Admin Login**
   - Admin logs in and receives JWT.

5. **Admin Creates Users**
   - Admin creates additional `user` or `admin` accounts within their org.

6. **Regular User Login**
   - Can log in for a start, view their own profile (`/users/me`). Other user features can be built upon this.

---

## Setup & Running

### Environment Variables

```
DATABASE_URL=postgresql+psycopg2://postgres:postgres@db:5432/rayda_db
JWT_SECRET_KEY=your_super_secret_here
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
INITIAL_SUPERADMIN_EMAIL=superadmin@example.com
INITIAL_SUPERADMIN_PASSWORD=SuperSecret123!
```

There is a `.env.example` file in the project folder showing the necessary variables for startup

---

### Docker

```bash
docker-compose up --build
```

- Automatically runs migrations.
- Boots superadmin account.
- Starts FastAPI server on `http://0.0.0.0:8000`.

---

## Basic API Endpoints Summary

| Endpoint                      | Method | Role            | Purpose                                      |
|-------------------------------|---------|----------------|----------------------------------------------|
| `/users/login`                | POST    | All            | Obtain JWT token.                            |
| `/users/me`                   | GET     | All            | Get own profile.                             |
| `/orgs/`                      | POST    | Superadmin | Create new org & initial admin.              |
| `/orgs/{org_id}`             | GET     | All            | Get org info.                                |
| `/users/`                    | POST    | Admin        | Create users and/or other admins inside org. |

---

## Security Notes

- **JWT Authentication**: All secure routes require a Bearer token.
- **Password Hashing**: Using bcrypt via passlib.
- **Role Enforcement**: Strict checks at each route level.
- **Tenant Data Isolation**: All user actions scoped to `org_id`.

---

## Future Improvements

- Invitation-based user onboarding with email confirmation.
- Fully integrated audit logs for all data modifications.
- External service webhooks with retry logic (Phase 2).
- SSO integrations (SAML/OIDC).
- Circuit breaker and external API health monitoring.

---

## Credits / Author

- **Architect & Developer**: David Nwobodo

---

## Final Note

This project emphasizes **secure design**, **explicit access control**, and **real-world SaaS workflows**.  
It is intended not just as code, but as a foundation and showcase of architectural clarity and thoughtful backend design.

---

### ðŸ’¬ "Documentation is not just about code, it's about ideas."